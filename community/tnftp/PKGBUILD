# $Id: PKGBUILD 5563 2009-11-10 12:05:54Z spupykin $
# Contributor: Geoffroy Carrier <geoffroy.carrier@koon.fr>
# Previous Contributor: Baptiste Daroussin <baptiste.daroussin@gmail.com>

pkgname=tnftp
pkgver=20090606
pkgrel=1
pkgdesc="NetBSD FTP client with several advanced features"
arch=('i686' 'x86_64')
url="ftp://ftp.netbsd.org/pub/NetBSD/misc/tnftp/"
license=('BSD')
depends=('ncurses')
conflicts=('inetutils')
source=(ftp://ftp.netbsd.org/pub/NetBSD/misc/tnftp/$pkgname-$pkgver.tar.gz)
md5sums=('681c1d9d064fa38c6f39b95f9e0b4941')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  sed -i 's/ARG_MAX/sysconf(_SC_ARG_MAX)/' libnetbsd/glob.c

  ./configure --prefix=/usr\
	--enable-editcomplete || return 1

  sed -i 's|getline|my_getline|' src/*
  export CLAGS="$CFLAGS -DUSE_POSIX"
  make || return 1

  install -Dm755 "$srcdir/$pkgname-$pkgver/src/ftp" "$pkgdir/usr/bin/ftp" && \
  install -Dm644 "$srcdir/$pkgname-$pkgver/src/ftp.1" "$pkgdir/usr/man/man1/ftp.1" && \
  install -Dm755 COPYING ${pkgdir}/usr/share/licenses/${pkgname}/COPYING && \
  mv ${pkgdir}/usr/man ${pkgdir}/usr/share/man
}
