# Contributor: Nicolas Doualot <packages@slubman.info>
# vim:set ts=2 sw=2 et:
pkgname=neatx
pkgver=0.3.1
pkgrel=7
pkgdesc="A free NX server by google"
arch=('i686' 'x86_64')
url="http://code.google.com/p/neatx/"
license=('GPL')
depends=('nxserver' 'python-pexpect' 'python-simplejson' 'netcat' 'pygtk')
makedepends=('docutils')
optdepends=('xorg-xdm: if you want to use KDE or GNOME session'
	    'xterm: if you want console session')
install=neatx.install
source=(http://neatx.googlecode.com/files/$pkgname-$pkgver.tar.gz
        constants.archlinux.patch)
md5sums=('5748656738d5f04fef1af01b9fe5ef20'
         'a5ca4aa399cc25fa8435280e8b03c5a3')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -i "$srcdir/constants.archlinux.patch" -p2 || return 1

  ./configure --prefix=/usr --localstatedir=/var RST2HTML=/usr/bin/rst2html
  make || return 1
  make DESTDIR="$pkgdir/" install || return 1
  chmod 777 "$pkgdir/var/lib/neatx/sessions"

  install -d -m755 ${pkgdir}/etc/ld.so.conf.d/
  echo '/opt/NX/lib' > ${pkgdir}/etc/ld.so.conf.d/neatx.conf
}
