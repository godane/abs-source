# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=sbaz
pkgver=1.25
_junitver=3.8.1
pkgrel=1
pkgdesc="A Java-interoperable language with object-oriented and functional features"
arch=('any')
url="http://www.lexspoon.org/sbaz/"
license=('GPL')
depends=('java-runtime' 'scala' 'sh')
makedepends=('apache-ant' 'tomcat')
source=(http://www.lexspoon.org/sbaz/downloads/sbaz-$pkgver.tar.gz
	http://downloads.sourceforge.net/project/junit/junit/${_junitver}/junit${_junitver}.zip
	build.xml.patch)
md5sums=('564ca19401621d9b2fe6c1dd2c6fe637'
         '5110326e4b7f7497dfa60ede4b626751'
         '3467142f6104615c99ebba2f4ede65e1')

build(){
    mv $srcdir/junit${_junitver}/junit.jar $srcdir/${pkgname}-${pkgver}/junit.jar
    cd ${srcdir}/${pkgname}-${pkgver}
    patch -p0 build.xml <$srcdir/build.xml.patch || return 1
    ant dist || return 1

    mkdir -p $pkgdir/usr/share/scala
    cd $pkgdir/usr/share/scala && \
    jar xf $srcdir/sbaz-$pkgver/dists/sbaz-$pkgver.sbp || return 1

    rm -f bin/sbaz.bat
    chmod 0755 bin/sbaz && \
    install -D -m0755 bin/sbaz $pkgdir/usr/bin/sbaz
}
